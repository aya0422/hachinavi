{"ast":null,"code":"import React,{useState,useRef,useEffect,useCallback}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const QuestionsPage=_ref=>{let{currentQuestionIndex,questions,onAnswer}=_ref;const[isDragging,setIsDragging]=useState(false);const[dragOffset,setDragOffset]=useState(0);const[startX,setStartX]=useState(0);const cardRef=useRef(null);// マウス/タッチ操作中\nconst handleMove=useCallback(clientX=>{if(!isDragging)return;const offset=clientX-startX;setDragOffset(offset);},[isDragging,startX]);// マウス/タッチ操作終了\nconst handleEnd=useCallback(()=>{if(!isDragging)return;setIsDragging(false);const threshold=100;// スワイプ判定の閾値\nif(Math.abs(dragOffset)>threshold){if(dragOffset>0){// 右スワイプ = いいえ\nif(questions[currentQuestionIndex]){onAnswer(questions[currentQuestionIndex].id,false);}}else{// 左スワイプ = はい\nif(questions[currentQuestionIndex]){onAnswer(questions[currentQuestionIndex].id,true);}}}setDragOffset(0);},[isDragging,dragOffset,questions,currentQuestionIndex,onAnswer]);// グローバルマウスイベントの設定\nuseEffect(()=>{if(isDragging){const handleGlobalMouseMove=e=>{handleMove(e.clientX);};const handleGlobalMouseUp=e=>{handleEnd();};document.addEventListener('mousemove',handleGlobalMouseMove);document.addEventListener('mouseup',handleGlobalMouseUp);return()=>{document.removeEventListener('mousemove',handleGlobalMouseMove);document.removeEventListener('mouseup',handleGlobalMouseUp);};}},[isDragging,handleMove,handleEnd]);if(questions.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:\"\\u8CEA\\u554F\\u304C\\u898B\\u3064\\u304B\\u308A\\u307E\\u305B\\u3093\"});}const currentQuestion=questions[currentQuestionIndex];const progress=(currentQuestionIndex+1)/questions.length*100;// マウス/タッチ操作開始\nconst handleStart=clientX=>{setIsDragging(true);setStartX(clientX);setDragOffset(0);};// マウスイベント\nconst handleMouseDown=e=>{e.preventDefault();handleStart(e.clientX);};// タッチイベント\nconst handleTouchStart=e=>{handleStart(e.touches[0].clientX);};const handleTouchMove=e=>{handleMove(e.touches[0].clientX);};const handleTouchEnd=e=>{handleEnd();};// カードの変形計算\nconst getCardStyle=()=>{const rotation=dragOffset*0.1;// 回転角度\nconst opacity=Math.max(0.7,1-Math.abs(dragOffset)*0.002);return{transform:\"translateX(\".concat(dragOffset,\"px) rotate(\").concat(rotation,\"deg)\"),opacity,transition:isDragging?'none':'all 0.3s ease-out'};};// スワイプ方向の表示\nconst getSwipeIndicator=()=>{if(Math.abs(dragOffset)<50)return null;if(dragOffset>0){return/*#__PURE__*/_jsx(\"div\",{className:\"swipe-indicator no\",children:\"\\u3044\\u3044\\u3048\"});}else{return/*#__PURE__*/_jsx(\"div\",{className:\"swipe-indicator yes\",children:\"\\u306F\\u3044\"});}};return/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"question-swipe-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"progress\",children:[\"\\u8CEA\\u554F \",currentQuestionIndex+1,\" / \",questions.length]}),/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar\",children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-fill\",style:{width:\"\".concat(progress,\"%\")}})}),/*#__PURE__*/_jsx(\"div\",{className:\"answer-instructions\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"\\u30B9\\u30EF\\u30A4\\u30D7\\u3067\\u56DE\\u7B54\\u3057\\u3066\\u304F\\u3060\\u3055\\u3044\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"swipe-instructions\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"instruction-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"swipe-arrow left\",children:\"\\u2190\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\\u306F\\u3044\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"instruction-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u3044\\u3044\\u3048\"}),/*#__PURE__*/_jsx(\"span\",{className:\"swipe-arrow right\",children:\"\\u2192\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"question-card-stack\",children:/*#__PURE__*/_jsxs(\"div\",{ref:cardRef,className:\"question-card swipeable\",style:getCardStyle(),onMouseDown:handleMouseDown,onTouchStart:handleTouchStart,onTouchMove:handleTouchMove,onTouchEnd:handleTouchEnd,children:[/*#__PURE__*/_jsx(\"div\",{className:\"question-text\",children:currentQuestion.text}),getSwipeIndicator()]})})]})});};export default QuestionsPage;","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","jsx","_jsx","jsxs","_jsxs","QuestionsPage","_ref","currentQuestionIndex","questions","onAnswer","isDragging","setIsDragging","dragOffset","setDragOffset","startX","setStartX","cardRef","handleMove","clientX","offset","handleEnd","threshold","Math","abs","id","handleGlobalMouseMove","e","handleGlobalMouseUp","document","addEventListener","removeEventListener","length","className","children","currentQuestion","progress","handleStart","handleMouseDown","preventDefault","handleTouchStart","touches","handleTouchMove","handleTouchEnd","getCardStyle","rotation","opacity","max","transform","concat","transition","getSwipeIndicator","style","width","ref","onMouseDown","onTouchStart","onTouchMove","onTouchEnd","text"],"sources":["/Users/ishikawaaya/hachinavi/src/pages/QuestionsPage.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { Question, UserAnswers } from '../types';\n\ninterface QuestionsPageProps {\n  userAnswers: UserAnswers;\n  currentQuestionIndex: number;\n  questions: Question[];\n  onAnswer: (questionId: string, answer: boolean) => void;\n}\n\nconst QuestionsPage: React.FC<QuestionsPageProps> = ({\n  currentQuestionIndex,\n  questions,\n  onAnswer\n}) => {\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragOffset, setDragOffset] = useState(0);\n  const [startX, setStartX] = useState(0);\n  const cardRef = useRef<HTMLDivElement>(null);\n\n  // マウス/タッチ操作中\n  const handleMove = useCallback((clientX: number) => {\n    if (!isDragging) return;\n    \n    const offset = clientX - startX;\n    setDragOffset(offset);\n  }, [isDragging, startX]);\n\n  // マウス/タッチ操作終了\n  const handleEnd = useCallback(() => {\n    if (!isDragging) return;\n    \n    setIsDragging(false);\n    \n    const threshold = 100; // スワイプ判定の閾値\n    \n    if (Math.abs(dragOffset) > threshold) {\n      if (dragOffset > 0) {\n        // 右スワイプ = いいえ\n        if (questions[currentQuestionIndex]) {\n          onAnswer(questions[currentQuestionIndex].id, false);\n        }\n      } else {\n        // 左スワイプ = はい\n        if (questions[currentQuestionIndex]) {\n          onAnswer(questions[currentQuestionIndex].id, true);\n        }\n      }\n    }\n    \n    setDragOffset(0);\n  }, [isDragging, dragOffset, questions, currentQuestionIndex, onAnswer]);\n\n  // グローバルマウスイベントの設定\n  useEffect(() => {\n    if (isDragging) {\n      const handleGlobalMouseMove = (e: MouseEvent) => {\n        handleMove(e.clientX);\n      };\n\n      const handleGlobalMouseUp = (e: MouseEvent) => {\n        handleEnd();\n      };\n\n      document.addEventListener('mousemove', handleGlobalMouseMove);\n      document.addEventListener('mouseup', handleGlobalMouseUp);\n\n      return () => {\n        document.removeEventListener('mousemove', handleGlobalMouseMove);\n        document.removeEventListener('mouseup', handleGlobalMouseUp);\n      };\n    }\n  }, [isDragging, handleMove, handleEnd]);\n\n  if (questions.length === 0) {\n    return <div className=\"content\">質問が見つかりません</div>;\n  }\n\n  const currentQuestion = questions[currentQuestionIndex];\n  const progress = ((currentQuestionIndex + 1) / questions.length) * 100;\n\n  // マウス/タッチ操作開始\n  const handleStart = (clientX: number) => {\n    setIsDragging(true);\n    setStartX(clientX);\n    setDragOffset(0);\n  };\n\n  // マウスイベント\n  const handleMouseDown = (e: React.MouseEvent) => {\n    e.preventDefault();\n    handleStart(e.clientX);\n  };\n\n  // タッチイベント\n  const handleTouchStart = (e: React.TouchEvent) => {\n    handleStart(e.touches[0].clientX);\n  };\n\n  const handleTouchMove = (e: React.TouchEvent) => {\n    handleMove(e.touches[0].clientX);\n  };\n\n  const handleTouchEnd = (e: React.TouchEvent) => {\n    handleEnd();\n  };\n\n  // カードの変形計算\n  const getCardStyle = () => {\n    const rotation = dragOffset * 0.1; // 回転角度\n    const opacity = Math.max(0.7, 1 - Math.abs(dragOffset) * 0.002);\n    \n    return {\n      transform: `translateX(${dragOffset}px) rotate(${rotation}deg)`,\n      opacity,\n      transition: isDragging ? 'none' : 'all 0.3s ease-out'\n    };\n  };\n\n  // スワイプ方向の表示\n  const getSwipeIndicator = () => {\n    if (Math.abs(dragOffset) < 50) return null;\n    \n    if (dragOffset > 0) {\n      return <div className=\"swipe-indicator no\">いいえ</div>;\n    } else {\n      return <div className=\"swipe-indicator yes\">はい</div>;\n    }\n  };\n\n  return (\n    <div className=\"content\">\n      <div className=\"question-swipe-container\">\n        <div className=\"progress\">\n          質問 {currentQuestionIndex + 1} / {questions.length}\n        </div>\n        <div className=\"progress-bar\">\n          <div \n            className=\"progress-fill\" \n            style={{ width: `${progress}%` }}\n          />\n        </div>\n        \n        <div className=\"answer-instructions\">\n          <h3>スワイプで回答してください</h3>\n        </div>\n        \n        <div className=\"swipe-instructions\">\n          <div className=\"instruction-item\">\n            <span className=\"swipe-arrow left\">←</span>\n            <span>はい</span>\n          </div>\n          <div className=\"instruction-item\">\n            <span>いいえ</span>\n            <span className=\"swipe-arrow right\">→</span>\n          </div>\n        </div>\n\n        <div className=\"question-card-stack\">\n          <div \n            ref={cardRef}\n            className=\"question-card swipeable\"\n            style={getCardStyle()}\n            onMouseDown={handleMouseDown}\n            onTouchStart={handleTouchStart}\n            onTouchMove={handleTouchMove}\n            onTouchEnd={handleTouchEnd}\n          >\n            <div className=\"question-text\">\n              {currentQuestion.text}\n            </div>\n            \n            {getSwipeIndicator()}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default QuestionsPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}